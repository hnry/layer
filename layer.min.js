// Copyright 2013 lovebear https://github.com/lovebear/layer.js
"use strict";var layer={};"undefined"!=typeof module&&module.exports&&(layer._isNode=!0),layer._default_context=layer._isNode?module.parent.exports:this,layer._find_context=function(t,e){for(var r=Object.keys(t),o=0,n=r.length;n>o;o++){var l=t[r[o]];if(l&&l===e)return[t,r[o]]}throw Error("Unable to find context")},layer.Stop=function(){},layer.set=function(t,e,r){var o=!1;t||(t=layer._default_context);var n=this._find_context(t,e,this._context_level);if(n){var l=n[0][n[1]];n[0][n[1]]=function(){var t=r.apply(n[0],Array.prototype.slice.call(arguments));if(!(t&&t instanceof layer.Stop)){var e;if(t?Array.isArray(t)?(t=Array.prototype.slice.call(t),e=l.apply(n[0],t)):e=l.call(n[0],t):e=l.call(n[0]),e)return e}},n[0][n[1]].skip=l,n[0][n[1]].skip._context=n[0],o=!0}if(!o)throw Error("Could not set proxy")},layer.unset=function(t){var e=!1,r=t.skip;if(t.skip&&t.skip._context){var o=this._find_context(t.skip._context,t,this._context_level);o&&(r._context&&delete r._context,o[0][o[1]]=r,e=!0)}if(!e)throw Error("Could not unset proxy")},layer.replace=function(t,e,r){var o=!1,n=this._find_context(t,e,this._context_level);if(n&&(n[0][n[1]]=r,o=!0),!o)throw Error("Could not replace function")},layer._isNode&&(module.exports=layer);